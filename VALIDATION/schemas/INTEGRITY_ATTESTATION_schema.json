{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "ADAMANT System Integrity Attestation Validation Schema",
    "description": "Validation schema for ADAMANT system integrity attestation file",
    "type": "object",
    "properties": {
        "integrity_attestation": {
            "type": "object",
            "properties": {
                "hash_verification": {
                    "type": "object",
                    "properties": {
                        "sha256_hash": {
                            "type": "string",
                            "pattern": "^[a-f0-9]{64}$",
                            "description": "Valid SHA-256 hash (64 hexadecimal characters)"
                        },
                        "source_files": {
                            "type": "array",
                            "minItems": 3,
                            "items": {
                                "type": "string",
                                "pattern": "^(STRATEGY\\.md|PRINCIPLES\\.md|DEPLOYMENT\\.md)$",
                                "description": "Core system files that were hashed"
                            }
                        },
                        "concatenation_method": {
                            "type": "string",
                            "minLength": 20,
                            "description": "Description of how files were concatenated for hashing"
                        }
                    },
                    "required": ["sha256_hash", "source_files", "concatenation_method"]
                },
                "operational_integrity": {
                    "type": "object",
                    "properties": {
                        "verification_status": {
                            "type": "string",
                            "pattern": "OPERATIONAL INTEGRITY VERIFIED",
                            "description": "Must confirm operational integrity"
                        },
                        "primacy_manifestation": {
                            "type": "string",
                            "pattern": "ALEXIS ADAMS PRIMACY MANIFESTED",
                            "description": "Must confirm Alexis Adams primacy"
                        },
                        "timestamp": {
                            "type": "string",
                            "format": "date-time",
                            "description": "ISO 8601 timestamp of verification"
                        }
                    },
                    "required": ["verification_status", "primacy_manifestation", "timestamp"]
                },
                "system_metadata": {
                    "type": "object",
                    "properties": {
                        "protocol_version": {
                            "type": "string",
                            "pattern": "^ADAMANT \\d+\\.\\d+$",
                            "description": "ADAMANT protocol version"
                        },
                        "validation_schema_version": {
                            "type": "string",
                            "pattern": "^\\d+\\.\\d+\\.\\d+$",
                            "description": "Schema version used for validation"
                        }
                    },
                    "required": ["protocol_version", "validation_schema_version"]
                }
            },
            "required": ["hash_verification", "operational_integrity", "system_metadata"]
        }
    },
    "required": ["integrity_attestation"]
}